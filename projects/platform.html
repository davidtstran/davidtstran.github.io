<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" href="/style.css">
	<title>Platformer</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
	<script type="text/javascript" src="https://static.codehs.com/gulp/a207eaf74c9a65ef1504f82657de97532616341f/chs-js-lib/chs.js"></script>
</head>
<body>
	<header id = "header">(<a href = "https://davidtstran.github.io" style="color:darkgray">Home</a>)
		David Tran Header
		(<a href = "https://github.com/davidtstran" style="color:darkgray">GitHub</a>) </header> <br> <br> <br>
	<h2>WASD\/Arrows<br> </h2>
	
	<p align = "center">
		<input id = "start" type = "button" value = "Start" onclick = "start()"> <br> <br>
		<canvas width="500" height="500" class="codehs-editor-canvas" style="background-color:#87CEEB"></canvas>
	</p>
	
<script>
function start() {
	removeAll(); // clear canvas
	stopAllTimers();
	
	var maps = [], currentMap = 0, totalMaps = 5, mapN;
	var blockSize = 25, blockColor = new Color(204, 102, 0), blockBorder = new Color (102, 51, 0);
	var numBlocks = getWidth() / blockSize;
	var person, personCenter;
	
	map(currentMap);
	personObject();
	keyDownMethod(movement);
	
	function platformBlock(xLoc, yLoc) {
		var block = new Rectangle (blockSize, blockSize);
		block.setColor(blockColor);
		block.setBorderColor(blockBorder);
		block.setPosition(xLoc, yLoc);
		add(block);
	}
	
	function personObject() {
		var startX = 0, startY = getHeight() - blockSize*2;
		var scale = 1;
		//person = new Polygon();
		//person.setColor(Color.black);
		//add(person);
		personCenter = new Circle(10);
		personCenter.setColor(Color.black);
		personCenter.setPosition(blockSize/2, getHeight() - blockSize - blockSize/2);
		add(personCenter);
	}
	function movement(e) {
		if (e.keyCode == Keyboard.UP || e.keyCode == Keyboard.letter('W')) {
			// JUMP
			personCenter.move(0, 0); 
			// JUMP
		}
		else if (e.keyCode == Keyboard.LEFT || e.keyCode == Keyboard.letter('A')) {
			if (personCenter.getX() - blockSize > 0)
				personCenter.move(-blockSize, 0);
			else
				changeMap(currentMap, currentMap - 1);
		}
		else if (e.keyCode == Keyboard.DOWN || e.keyCode == Keyboard.letter('S')) {
			// probably unneeded (falls because gravity)
			personCenter.move(0, 0);
			// probably unneeded (falls because gravity)
		}
		else if (e.keyCode == Keyboard.RIGHT || e.keyCode == Keyboard.letter('D')) {
			if (personCenter.getX() + blockSize < getHeight())
				personCenter.move(blockSize, 0);
			else
				changeMap(currentMap, currentMap + 1);
		}
	}
	function changeMap(curr, newM) {
		if (newM < totalMaps && newM >= 0) {
			if (newM > curr) {
				removeAll();
				personCenter.setPosition(blockSize/2, getHeight() - blockSize - blockSize/2);
				add(personCenter);
				currentMap++;
				map(currentMap);
			}
			else if (newM < curr) {
				removeAll();
				personCenter.setPosition(getWidth() - blockSize/2, getHeight() - blockSize - blockSize/2);
				add(personCenter);
				currentMap--;
				map(currentMap);
			}
		}
	}
	function map(number) {
		mapN = new Text(currentMap + 1);
		mapN.setPosition(getWidth() - mapN.getWidth(), 0 + mapN.getHeight());
		mapN.setColor(Color.black);
		add(mapN);
		if (currentMap == 0 || currentMap == 1 || currentMap == 2 || currentMap == 3) {
			for (var i = 0; i < numBlocks; i++) {
				platformBlock(i * blockSize, getHeight() - blockSize);	
			}	
		}
		else if (currentMap == 4) {
			for (var i = 0; i < numBlocks; i++) {
				if (i != numBlocks - 2) {
					platformBlock(i * blockSize, getHeight() - blockSize);	
				}
			}
		}
	}
	
}	
	
</script>
	
	<br> <br> <br>
	<footer>(<a href = "https://davidtstran.github.io" style="color:darkgray">Home</a>)
		David Tran Footer
		(<a href = "https://github.com/davidtstran" style="color:darkgray">GitHub</a>) </footer> 
</body>
</html>
