<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" href="/style.css">
	<title>Platformer</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
	<script type="text/javascript" src="https://static.codehs.com/gulp/a207eaf74c9a65ef1504f82657de97532616341f/chs-js-lib/chs.js"></script>
</head>
<body>
	<header id = "header">(<a href = "https://davidtstran.github.io" style="color:darkgray">Home</a>)
		David Tran Header
		(<a href = "https://github.com/davidtstran" style="color:darkgray">GitHub</a>) </header> <br> <br> <br>
	<h2>UP/JUMP/LEFT<br> </h2>
	
	<p align = "center">
		<input id = "start" type = "button" value = "Start" onclick = "start()"> <br> <br>
		<canvas width="500" height="500" class="codehs-editor-canvas" style="background-color:#87CEEB"></canvas>
	</p>
	
<script>
function start() {
	removeAll(); // clear canvas
	stopAllTimers();
	
	var maps = [], currentMap = 0, totalMaps = 5, mapN;
	var blockSize = 25, blockColor = new Color(204, 102, 0), blockBorder = new Color (102, 51, 0);
	var numBlocks = getWidth() / blockSize;
	var person, personCenter, newX, newY, numFalls = 0, fallsN, canJump = true;
	
	personObject();
	map(currentMap);
	keyDownMethod(movement);
	setTimer(checkBelow, 500); // change to fix fal
	
	function platformBlock(xLoc, yLoc) {
		var block = new Rectangle (blockSize, blockSize);
		block.setColor(blockColor);
		block.setBorderColor(blockBorder);
		block.setPosition(xLoc, yLoc);
		add(block);
	}
	
	function personObject() {
		fallTrack();
		var startX = 0, startY = getHeight() - blockSize*2;
		var scale = 1;
		//person = new Polygon();
		//person.setColor(Color.black);
		//add(person);
		personCenter = new Circle(10);
		personCenter.setColor(Color.black);
		personCenter.setPosition(blockSize/2, getHeight() - blockSize - blockSize/2);
		add(personCenter);
		newX = blockSize/2; // starting X
	}
	function fallTrack() {
		remove(fallsN);
		fallsN = new Text(numFalls);
		fallsN.setPosition(0 + fallsN.getWidth(), 0 + fallsN.getHeight());
		fallsN.setColor(Color.black);
		add(fallsN);
	}
	function movement(e) {
		if (e.keyCode == Keyboard.UP || e.keyCode == Keyboard.letter('W')) {
			// JUMP
			if (canJump) {
				var aboveElem = getElementAt(personCenter.getX(), personCenter.getY() - blockSize);
				if (aboveElem == null)
					personCenter.move(0, -blockSize * 2); 
			}
			// JUMP
		}
		else if (e.keyCode == Keyboard.LEFT || e.keyCode == Keyboard.letter('A')) {
			var leftElem = getElementAt(personCenter.getX() - blockSize, personCenter.getY());
			if (personCenter.getX() - blockSize > 0) {
				if (leftElem == null)
					personCenter.move(-blockSize, 0);
			}
			else
				changeMap(currentMap, currentMap - 1);
		}
		else if (e.keyCode == Keyboard.DOWN || e.keyCode == Keyboard.letter('S')) {
			// probably unneeded (falls because gravity)
			personCenter.move(0, 0);
			// probably unneeded (falls because gravity)
		}
		else if (e.keyCode == Keyboard.RIGHT || e.keyCode == Keyboard.letter('D')) {
			var rightElem = getElementAt(personCenter.getX() + blockSize, personCenter.getY());
			if (personCenter.getX() + blockSize < getHeight()) {
				if (rightElem == null)
					personCenter.move(blockSize, 0);
			}
			else
				changeMap(currentMap, currentMap + 1);
		}
	}
	function checkBelow() {
		var below = getElementAt(personCenter.getX(), personCenter.getY() + blockSize);
		if (below == null) {
			personCenter.move(0, blockSize);
			canJump = false;
		}
		else {
			canJump = true;	
		}
		if (personCenter.getY() >= getHeight()){
			remove(fallsN);
			numFalls++;
			fallTrack();
			personCenter.setPosition(newX, newY);
			add(personCenter);
		}
	}
	function changeMap(curr, newM) {
		if (newM < totalMaps && newM >= 0) {
			if (newM > curr) { // go into right, start at left
				removeAll();
				newX = blockSize/2; 
				currentMap++;
				map(currentMap);
			}
			else if (newM < curr) { // go into left, start at right
				removeAll();
				newX = getWidth() - blockSize/2;
				currentMap--;
				map(currentMap);
			}
		}
	}
	function map(number) {
		mapN = new Text(number + 1);
		mapN.setPosition(getWidth() - mapN.getWidth(), 0 + mapN.getHeight());
		mapN.setColor(Color.black);
		add(mapN);
		fallTrack();
		if (number == 0) {
			if (newX == blockSize/2 || newX == getWidth() - blockSize/2)
				newY = getHeight() - blockSize - blockSize/2;
			personCenter.setPosition(newX, newY);
			add(personCenter);
			for (var i = 0; i < numBlocks; i++) {
				if (i == 5 || i == 6 || i == 7)
					platformBlock(i * blockSize, getHeight() - blockSize * 3);
				else if (i == 8 || i == 9) 
					platformBlock(i * blockSize, getHeight() - blockSize * 5);
				else if (i == 10) {
					for (var j = 0; j < 6; j++) {
						platformBlock(i * blockSize, getHeight() - blockSize * j);	
					}
				}
				else if (i == 11) {
					platformBlock(i * blockSize, getHeight() - blockSize * 3);
					platformBlock(i * blockSize, getHeight() - blockSize);
				}
				else
					platformBlock(i * blockSize, getHeight() - blockSize);	
			}
		}
		else if (number == 1) {
			if (newX == blockSize/2)
				newY = getHeight() - blockSize - blockSize/2;
			else if (newX == getWidth() - blockSize/2)
				newY = getHeight() - blockSize * 15 - blockSize/2;
			personCenter.setPosition(newX, newY);
			add(personCenter);
			for (var i = 0; i < numBlocks; i++) {
				if (i == 0 || i == 1)
					platformBlock(i * blockSize, getHeight() - blockSize);
				else if (i == 2)
					platformBlock(i * blockSize, getHeight() - blockSize * 3);
				else if (i == 3 || i == 4)
					platformBlock(i * blockSize, getHeight() - blockSize * 5);
				else if (i == 5 || i == 6)
					platformBlock(i * blockSize, getHeight() - blockSize * 7);
				else if (i == 7 || i == 8 || i == 9)
					platformBlock(i * blockSize, getHeight() - blockSize * 9);
				else if (i == 10 || i == 11 || i == 12) 
					platformBlock(i * blockSize, getHeight() - blockSize * 11);	
				else if (i == 13 || i == 14) 
					platformBlock(i * blockSize, getHeight() - blockSize * 13);
				else if (i == 15) 
					platformBlock(i * blockSize, getHeight() - blockSize * 14);
				else 
					platformBlock(i * blockSize, getHeight() - blockSize * 15);	
			}
		}
		else if (number == 2) {
			if (newX == blockSize/2 || newX == getWidth() - blockSize/2)
				newY = getHeight() - blockSize * 5 - blockSize/2;
			personCenter.setPosition(newX, newY);
			add(personCenter);
			for (var i = 0; i < numBlocks; i++) {
				platformBlock(i * blockSize, getHeight() - blockSize * 5);
			}
		}
		else if (number == 3) {
			if (newX == blockSize/2 || newX == getWidth() - blockSize/2)
				newY = getHeight() - blockSize - blockSize/2;
			personCenter.setPosition(newX, newY);
			add(personCenter);
			for (var i = 0; i < numBlocks; i++) {
				if (i == 8 || i == 10) {
					platformBlock(i * blockSize, getHeight() - blockSize * 3);
					platformBlock(i * blockSize, getHeight() - blockSize * 5);
					platformBlock(i * blockSize, getHeight() - blockSize * 7);
					platformBlock(i * blockSize, getHeight() - blockSize * 9);
					platformBlock(i * blockSize, getHeight() - blockSize * 11);
					platformBlock(i * blockSize, getHeight() - blockSize * 13);
					platformBlock(i * blockSize, getHeight() - blockSize * 15);
				}
				else if (i == 9) {
					for (var j = 0; j < 15; j++){
						platformBlock(i * blockSize, getHeight() - blockSize*(j+2));	
					}
				}
				platformBlock(i * blockSize, getHeight() - blockSize);	
			}	
		}
		else if (number == 4) {
			if (newX == blockSize/2 || newX == getWidth() - blockSize/2)
				newY = getHeight() - blockSize * 3 - blockSize/2;
			personCenter.setPosition(newX, newY);
			add(personCenter);
			for (var i = 0; i < numBlocks; i++) {
				if (i == 3 || i == 4 || i == 5 || i == 6) {
					platformBlock(i * blockSize, getHeight() - blockSize * 4);
					platformBlock(i * blockSize, getHeight() - blockSize * 5);	
				}
				else if (i == numBlocks - 2) {
					platformBlock((i-3) * blockSize, getHeight() - blockSize * 2);
					platformBlock((i-2) * blockSize, getHeight() - blockSize);
					platformBlock((i-1) * blockSize, getHeight() - blockSize);
					platformBlock(i * blockSize, getHeight() - blockSize);
					platformBlock((i+1) * blockSize, getHeight() - blockSize);
				}	
				else
					platformBlock(i * blockSize, getHeight() - blockSize * 3);
			}
		}
	}
}	
	
</script>
	
	<br> <br> <br>
	<footer>(<a href = "https://davidtstran.github.io" style="color:darkgray">Home</a>)
		David Tran Footer
		(<a href = "https://github.com/davidtstran" style="color:darkgray">GitHub</a>) </footer> 
</body>
</html>
