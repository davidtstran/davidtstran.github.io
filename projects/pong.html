<html>
<head>
	<link rel="stylesheet" href="/style.css">
	<title>Pong Game</title>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

	<script type="text/javascript" src="https://static.codehs.com/gulp/a207eaf74c9a65ef1504f82657de97532616341f/chs-js-lib/chs.js"></script>
</head>

<body>

	<header>(<a href = "https://davidtstran.github.io" style="color:darkgray">Home</a>)
		David Tran Header
		(<a href = "https://github.com/davidtstran" style="color:darkgray">GitHub</a>) </header> <br> <br> <br>
	<h2>Click Start to Begin Game<br>Click Screen to Pause/Unpause Game<br></h2>
	
	<p align = "center">
		<input type = "button" value = "Start" onclick = "start()"> <br> <br>
		<canvas width="800" height="400" class="codehs-editor-canvas" style="background-color:black"></canvas>
	</p>
	
<script>
function start() {
	removeAll();
	var ball;
	var dx = 0;
	var dy = 0;
	
	var ballRadius = 10;
	var ballX = getWidth()/2;
	var ballY = getHeight()/2;
	
	var paddleL, paddleR;
	var pWidth = 10;
	var pHeight = 100;
	
	var pause = false;
	
	randomizeDir();
	addBall();
	addPaddles();
	setTimer(bounceBall, 20);
	mouseClickMethod(pauseGame);
	
	function randomizeDir() {
		var lr = Randomizer.nextInt(0, 1); // Left or Right
		var ud = Randomizer.nextInt(0, 1); // Up or Down
		if (lr == 0) { // Left
			dx = -5;
		}
		else if (lr == 1) { // Right
			dx = 5;				
		}
		if (ud == 0) { // Up
			dy = -5;
		}
		else if (ud == 1) { // Down
			dy = 5;
		}
	}
	
	function addBall() {
		ball = new Circle (ballRadius);
		ball.setColor(Color.white);
		ball.setPosition(ballX, ballY);
		add(ball);
	}
	
	function addPaddles() {
		paddleL = new Rectangle (pWidth, pHeight);
		paddleL.setColor(Color.white);
		paddleL.setPosition(0+pWidth,getHeight()/2-pHeight/2);
		add(paddleL);
	
		paddleR = new Rectangle (pWidth, pHeight);
		paddleR.setColor(Color.white);
		paddleR.setPosition(getWidth()-pWidth-pWidth,getHeight()/2-pHeight/2);
		add(paddleR);	
	}
	
	function bounceBall() {
		checkWalls();
		checkObjects();
		ball.move(dx, dy);	
	}
	
	function checkWalls() {
		// Bounce Off Top Wall
		if (ball.getY() - ball.getRadius() < 0){
			dy = -dy;
		}
		// Bounce Off Bottom Wall
		else if (ball.getY() + ball.getRadius() > getHeight()){
			dy = -dy;
		}
		// Reset Past Left or Right Wall
		else if ((ball.getX() - ball.getRadius() < 0) || (ball.getX() + ball.getRadius() > getWidth())){
			remove(ball);
			stopTimer(bounceBall);
			addBall();
			randomizeDir();
			setTimer(bounceBall, 20);
		}
	}
	
	function checkObjects() {
		var elem = getCollidingObjects();
		if (elem != null) {
			dx = -dx;
		}
	}
	
	function getCollidingObjects() {
		var left = getElementAt (ball.getX() - ball.getRadius(), ball.getY());
		var right = getElementAt (ball.getX() + ball.getRadius() + 1, ball.getY());
		var top = getElementAt (ball.getX(), ball.getY() - ball.getRadius());
		var bot = getElementAt (ball.getX(), ball.getY() + ball.getRadius());
		if (left)
			return left;
		else if (right)
			return right;
		else if (top)
			return top;
		else if (bot)
			return bot;
	}
	
	function pauseGame(e) {
		if (pause == true) {
			pause = false;
			setTimer(bounceBall, 20);
		}
		else if (pause == false) {
			pause = true;
			stopTimer(bounceBall);
		}
	}
}
</script>

	<footer>(<a href = "https://davidtstran.github.io" style="color:darkgray">Home</a>)
		David Tran Footer
		(<a href = "https://github.com/davidtstran" style="color:darkgray">GitHub</a>) </footer> 
</body>
</html>
