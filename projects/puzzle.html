<html>
<head>
	<link rel="stylesheet" href="/style.css">
	<title>Blocks Puzzle</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script type="text/javascript" src="https://static.codehs.com/gulp/a207eaf74c9a65ef1504f82657de97532616341f/chs-js-lib/chs.js"></script>
</head>

<body>
	<p align = "center">
		<canvas width="300" height="450" class="codehs-editor-canvas" style="background-color:black"></canvas>
	</p>
	
<script>
window.onload = function() {
	removeAll();
	stopAllTimers();
	
	var blockSize = 15;
	var blocksAcross = getWidth() / blockSize; // left 12 are for playing, rest is for score/next_puzzle
	var blocksDown = getHeight() / blockSize;
	var borderColor = new Color(112, 128, 144);
	var blocksPerPiece = 4;
	var colors = [ Color.cyan, Color.blue, Color.orange, Color.yellow, Color.green, Color.red, Color.purple ];
	
	function start() {
		layout();
		keyDownMethod(moveBlock);
		
		var pieceMove = Randomizer.nextInt(0, 6);
		var pieceDrop = returnPiece(pieceMove); // copy from original 
		for (var i = 0; i < blocksPerPiece; i++) {
				pieceDrop[i].setPosition(pieceDrop[i].getX() + blockSize*4, pieceDrop[i].getY() + blockSize);
				add(pieceDrop[i]);
		}
		
		/*  /// DISPLAYS PIECES
		for (var i = 0; i < pieces.length; i++) {  
			for (var j = 0; j < blocksPerPiece; j++) {
				pieces[i][j].setPosition(pieces[i][j].getX() * blockSize + blockSize, pieces[i][j].getY() * blockSize);
				add(pieces[i][j]);
				pieces[i][j].move(0, blockSize*(2*i))
			}
		}*/  /// DISPLAYS PIECES
	}
	
	function moveBlock(e) {
	
	}
	
	function layout() {
		var scoreArea = new Rectangle(blockSize * 8, getHeight());
		scoreArea.setColor(borderColor);
		scoreArea.setPosition(getWidth() - blockSize*8, 0);
		add(scoreArea);
		for (var i = 0; i < blocksAcross - 8; i++) {
			var border = new Rectangle(blockSize, blockSize);
			border.setColor(borderColor);
			border.setBorderColor(Color.black);
			border.setPosition(blockSize * i, getHeight() - blockSize);
			add(border);
		}
		for (var i = 0; i < blocksDown; i++) {
			var leftBorder = new Rectangle(blockSize, blockSize);
			leftBorder.setColor(borderColor);
			leftBorder.setBorderColor(Color.black);
			leftBorder.setPosition(0, blockSize * i);
			add(leftBorder);
			var rightBorder = new Rectangle(blockSize, blockSize);
			rightBorder.setColor(borderColor);
			rightBorder.setBorderColor(Color.black);
			rightBorder.setPosition(getWidth() - blockSize * 9, blockSize * i);
			add(rightBorder);
		}
	}
	
	function returnPiece(val) {
		var returnObj = [];
		if (val == 0) { // ---- 
			for (var i = 0; i < blocksPerPiece; i++) {
				returnObj[i] = new Rectangle(blockSize, blockSize);
				returnObj[i].setColor(colors[val]);
				returnObj[i].setPosition(i*blockSize, 1*blockSize);
			} 
		} // ----
		else if (val == 1) { // |--
			for (var i = 0; i < blocksPerPiece; i++) {
				returnObj[i] = new Rectangle(blockSize, blockSize);
				returnObj[i].setColor(colors[val]);
				if (i != 3) { returnObj[i].setPosition(i*blockSize, 1*blockSize); }
				else { returnObj[i].setPosition(0*blockSize, 0*blockSize); }
			} 
		} // |--
		else if (val == 2) { // --|
			for (var i = 0; i < blocksPerPiece; i++) {
				returnObj[i] = new Rectangle(blockSize, blockSize);
				returnObj[i].setColor(colors[val]);
				if (i != 0) { returnObj[i].setPosition(i*blockSize, 1*blockSize); }
				else { returnObj[i].setPosition(3*blockSize, 0*blockSize); }
			} 
		} // --|
		else if (val == 3) { // [--]
			for (var i = 0; i < blocksPerPiece; i++) {
				returnObj[i] = new Rectangle(blockSize, blockSize);
				returnObj[i].setColor(colors[val]);
				if (i == 0) { returnObj[i].setPosition(1*blockSize, 0*blockSize); }
				else if (i == 1 || i == 2) { returnObj[i].setPosition(i*blockSize, 1*blockSize); }
				else if (i == 3) { returnObj[i].setPosition(2*blockSize, 0*blockSize); }
			} 
		} // [--]
		else if (val == 4) { // _-
			for (var i = 0; i < blocksPerPiece; i++) {
				returnObj[i] = new Rectangle(blockSize, blockSize);
				returnObj[i].setColor(colors[val]);
				if (i == 0 || i == 1) { returnObj[i].setPosition(i*blockSize, 1*blockSize); }
				else if (i == 2) { returnObj[i].setPosition(1*blockSize, 0*blockSize); }
				else if (i == 3) { returnObj[i].setPosition(2*blockSize, 0*blockSize); }
			} 
		} // _-
		else if (val == 5) { // -_
			for (var i = 0; i < blocksPerPiece; i++) {
				returnObj[i] = new Rectangle(blockSize, blockSize);
				returnObj[i].setColor(colors[val]);
				if (i == 0 || i == 1) { returnObj[i].setPosition(i*blockSize, 0*blockSize); }
				else if (i == 2) { returnObj[i].setPosition(1*blockSize, 1*blockSize); }
				else if (i == 3) { returnObj[i].setPosition(2*blockSize, 1*blockSize); }
			} 
		} // -_
		else if (val == 6) { // _|_
			for (var i = 0; i < blocksPerPiece; i++) {
				returnObj[i] = new Rectangle(blockSize, blockSize);
				returnObj[i].setColor(colors[val]);
				if (i != 3) { returnObj[i].setPosition(i*blockSize, 1*blockSize); }
				else { returnObj[i].setPosition(1*blockSize, 0*blockSize); }
			} 
		} // _|_
		return returnObj;
	}
	
	if (typeof start == 'function')
		start();
}
</script>
	
</body>
</html>
