<html>
<head>
	<link rel="stylesheet" href="/style.css">
	<title>Blocks Puzzle</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script type="text/javascript" src="https://static.codehs.com/gulp/a207eaf74c9a65ef1504f82657de97532616341f/chs-js-lib/chs.js"></script>
</head>

<body>
	<p align = "center">
		<canvas width="300" height="450" class="codehs-editor-canvas" style="background-color:black"></canvas>
	</p>
	
<script>
window.onload = function() {
	removeAll();
	stopAllTimers();
	
	var blockSize = 15;
	var blocksAcross = getWidth() / blockSize; // left 12 are for playing, rest is for score/next_puzzle
	var blocksDown = getHeight() / blockSize;
	var borderColor = new Color(112, 128, 144);
	var pieces = [], blocksPerPiece = 4;
	var pieceDrop, pieceMove; // array, integer that correlates to piece index 
	var colors = [ Color.cyan, Color.blue, Color.orange, Color.yellow, Color.green, Color.red, Color.purple ];
	
	function start() {
		layout();
		piecesInArray();
		keyDownMethod(moveBlock);
		
		pieceMove = Randomizer.nextInt(0, 6);
		pieceDrop = []; // copy from original 
		for (var i = 0; i < blocksPerPiece; i++) { pieceDrop[i] = pieces[pieceMove][i]; } // copy from original 
		for (var i = 0; i < blocksPerPiece; i++) {
				pieceDrop[i].setPosition(pieceDrop[i].getX() + blockSize*4, pieceDrop[i].getY() + blockSize);
				add(pieceDrop[i]);
		}
		
		/*  /// DISPLAYS PIECES
		for (var i = 0; i < pieces.length; i++) {  
			for (var j = 0; j < blocksPerPiece; j++) {
				pieces[i][j].setPosition(pieces[i][j].getX() * blockSize + blockSize, pieces[i][j].getY() * blockSize);
				add(pieces[i][j]);
				pieces[i][j].move(0, blockSize*(2*i))
			}
		}*/  /// DISPLAYS PIECES
	}
	
	function moveBlock(e) {
	
	}
	
	function layout() {
		var scoreArea = new Rectangle(blockSize * 8, getHeight());
		scoreArea.setColor(borderColor);
		scoreArea.setPosition(getWidth() - blockSize*8, 0);
		add(scoreArea);
		for (var i = 0; i < blocksAcross - 8; i++) {
			var border = new Rectangle(blockSize, blockSize);
			border.setColor(borderColor);
			border.setBorderColor(Color.black);
			border.setPosition(blockSize * i, getHeight() - blockSize);
			add(border);
		}
		for (var i = 0; i < blocksDown; i++) {
			var leftBorder = new Rectangle(blockSize, blockSize);
			leftBorder.setColor(borderColor);
			leftBorder.setBorderColor(Color.black);
			leftBorder.setPosition(0, blockSize * i);
			add(leftBorder);
			var rightBorder = new Rectangle(blockSize, blockSize);
			rightBorder.setColor(borderColor);
			rightBorder.setBorderColor(Color.black);
			rightBorder.setPosition(getWidth() - blockSize * 9, blockSize * i);
			add(rightBorder);
		}
	}
	
	function piecesInArray() { // every piece is in 2row&4col area [0,3]&[0,1]
		pieces[0] = []; // ---- 
		for (var i = 0; i < blocksPerPiece; i++) {
			pieces[0][i] = new Rectangle(blockSize, blockSize);
			pieces[0][i].setColor(colors[0]);
			pieces[0][i].setPosition(i*blockSize, 1*blockSize);
		} // ----
		pieces[1] = []; // |--
		for (var i = 0; i < blocksPerPiece; i++) {
			pieces[1][i] = new Rectangle(blockSize, blockSize);
			pieces[1][i].setColor(colors[1]);
			if (i != 3) { pieces[1][i].setPosition(i*blockSize, 1*blockSize); }
			else { pieces[1][i].setPosition(0*blockSize, 0*blockSize); }
		} // |--
		pieces[2] = []; // --|
		for (var i = 0; i < blocksPerPiece; i++) {
			pieces[2][i] = new Rectangle(blockSize, blockSize);
			pieces[2][i].setColor(colors[2]);
			if (i != 0) { pieces[2][i].setPosition(i*blockSize, 1*blockSize); }
			else { pieces[2][i].setPosition(3*blockSize, 0*blockSize); }
		} // --|
		pieces[3] = []; // [--]
		for (var i = 0; i < blocksPerPiece; i++) {
			pieces[3][i] = new Rectangle(blockSize, blockSize);
			pieces[3][i].setColor(colors[3]);
			if (i == 0) { pieces[3][i].setPosition(1*blockSize, 0*blockSize); }
			else if (i == 1 || i == 2) { pieces[3][i].setPosition(i*blockSize, 1*blockSize); }
			else if (i == 3) { pieces[3][i].setPosition(2*blockSize, 0*blockSize); }
		} // [--]
		pieces[4] = []; // _-
		for (var i = 0; i < blocksPerPiece; i++) {
			pieces[4][i] = new Rectangle(blockSize, blockSize);
			pieces[4][i].setColor(colors[4]);
			if (i == 0 || i == 1) { pieces[4][i].setPosition(i*blockSize, 1*blockSize); }
			else if (i == 2) { pieces[4][i].setPosition(1*blockSize, 0*blockSize); }
			else if (i == 3) { pieces[4][i].setPosition(2*blockSize, 0*blockSize); }
		} // _-
		pieces[5] = []; // -_
		for (var i = 0; i < blocksPerPiece; i++) {
			pieces[5][i] = new Rectangle(blockSize, blockSize);
			pieces[5][i].setColor(colors[5]);
			if (i == 0 || i == 1) { pieces[5][i].setPosition(i*blockSize, 0*blockSize); }
			else if (i == 2) { pieces[5][i].setPosition(1*blockSize, 1*blockSize); }
			else if (i == 3) { pieces[5][i].setPosition(2*blockSize, 1*blockSize); }
		} // -_
		pieces[6] = []; // _|_
		for (var i = 0; i < blocksPerPiece; i++) {
			pieces[6][i] = new Rectangle(blockSize, blockSize);
			pieces[6][i].setColor(colors[6]);
			if (i != 3) { pieces[6][i].setPosition(i*blockSize, 1*blockSize); }
			else { pieces[6][i].setPosition(1*blockSize, 0*blockSize); }
		} // _|_
	}
	
	if (typeof start == 'function')
		start();
}
</script>
	
</body>
</html>
